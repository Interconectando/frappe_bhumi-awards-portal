{% set colleges = frappe.get_all('College', fields=['college_name', 'location', 'total_votes'], limit_page_length=30) %}

<h2 class="mx-auto my-3 text-center">College Listing</h2>
    
<div class="row m-0 p-0">
    <div class="container col-lg-2 my-3 p-0">
        <div class="form-group">
            <label for="input-name-search">Search College</label>
            <input type="text" class="form-control" id="input-name-search" placeholder="Enter college name">
        </div>
        <div class="form-group">
            <label for="input-sort">Sort By</label>
            <select name="input-sort" id="input-sort" class="form-control">
                <option value="total_votes" selected># of votes</option>
                <option value="name">College Name</option>
                <option value="location">College Location</option>
            </select>
        </div>
        <div class="form-group">
            <label for="input-location-search">Filter By Location</label>
            <input type="text" class="form-control" id="input-location-search" placeholder="Enter location">
        </div>
    </div>
    
    <main class="col-lg-10">
        <div class="container pt-5">
            <div id="college-listings" class="row align-items-stretch">
                {% for college in colleges %}
                <div class="col-lg-4 col-sm-12 col-md-6 mb-4">
                    <div class="card w-100 h-100">
                        <div class="card-body text-center">
                            <div class="mx-auto mb-3 rounded-circle bg-success text-white d-flex align-items-center display-4 justify-content-center" style="height: 100px; width: 100px;">{{ frappe.utils.get_abbr(college.college_name) }}</div>
                            <h5 class="card-title font-weight-bold">{{ college.college_name }}</h5>
                            <p class="card-text d-block mb-4">{{ college.location }}</p>
                            <div class="d-flex justify-content-between align-items-center card-footer bg-transparent">
                                <p class="m-0 p-0 mr-1">
                                    {{ college.total_votes }}
                                    {% if college.total_votes == 1 %} 
                                        vote
                                    {% else %}
                                        votes
                                    {% endif %}
                                </p>
                                <a href="/vote" class="btn btn-primary">Vote Now</a>
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    
        <nav class="d-flex justify-content-center w-100 mt-5" aria-label="Page navigation">
            <button id="load-more-button" class="btn btn-secondary">Load More</button>
        </nav>
    </main>
</div>

{% block script %}
    {{ include_script('colleges.bundle.js') }}
{% endblock %}
